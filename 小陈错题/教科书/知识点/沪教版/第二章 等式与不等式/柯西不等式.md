# 柯西不等式

> 1. [高中不等式技巧（2）——柯西不等式](https://zhuanlan.zhihu.com/p/594083412)
>    1. [三道题入门柯西不等式](https://zhuanlan.zhihu.com/p/161465399)
> 2. [高中不等式技巧（3）——权方和不等式](https://zhuanlan.zhihu.com/p/593987184)
> 3. [反向柯西不等式在高考数学、竞赛数学中应用](https://zhuanlan.zhihu.com/p/713153110)


在求二元(或多元)代数式最值或者二元(或多元)不等式的证明的题目中，巧用柯西不等式会比较方便快捷。

## 二元形式 

对于任意实数 $a,b,c,d$，则

$$
(a^{2}+b^{2})(c^{2}+d^{2})\geqslant (ac+bd)^{2} \tag{0}
$$

当且仅当 $ ad=bc$ 时成立。

> [!NOTE]
>
> 拓展形式，设 $n\geqslant2$ 是正整数且 $x_1, x_2, ..., x_n$ 和 $y_1, y_2, ..., y_n \in \mathbf{R}$，则有:
> $$
> \left(\sum_{i=1}^{n} x_{i}^{2}\right)\left(\sum_{i=1}^{n} y_{i}^{2}\right)\geqslant\left(\sum_{i=1}^{n} x_{i} y_{i}\right)^{2}
> $$
>
> 当且仅当   $\dfrac{x_1}{y_1} = \dfrac{x_2}{y_2} = ... = \dfrac{x_n}{y_n} $ 时取到等号。
>

## 二元形式的证明

###  代数法
$$
\begin{aligned}
(a^2+b^2)(c^2+d^2)&=a^2c^2+b^2d^2+a^2d^2+b^2c^2\\
&=a^2c^2+2abcd+b^2d^2+a^2d^2-2abcd+b^2c^2 \\
&=(ac+bd)^2+(ad-bc)^2\\
&\geqslant(ac+bd)^2
\end{aligned}
$$
等号在且仅在 $ad-bc=0$，即 $ad=bc$ 或者 $\dfrac{a}{b} = \dfrac{c}{d}$ 时成立。

### 几何法
![](https://pic3.zhimg.com/v2-941708a7fe838f1da2b8318208fa618a_1440w.jpg)

参考上图，根据面积公式可得等式：
$$
\dfrac{(a+d)(b+c)}{2}=\dfrac{ab}{2}+\dfrac{cd}{2}+\dfrac{\sqrt{a^{2}+b^{2}}\sqrt{c^{2}+d^{2}}\sin\alpha}{2}
$$

整理得：
$$
\begin{aligned}
ac+bd &= \sqrt{a^{2}+b^{2}}\sqrt{c^{2}+d^{2}}\sin\alpha\ \Rightarrow \\
ac+bd & \leqslant \sqrt{a^{2}+b^{2}}\sqrt{c^{2}+d^{2}}\ \Rightarrow \\
(ac + bd)^2 &\leqslant (a^2 + b^2)(c^2 + d^2)
\end{aligned}
$$

当且仅当 $\sin\alpha=1$ 时，即 $ ad=bc$ 时，等号成立

## 权方和不等式

**权方和不等式**可以从著名的**柯西不等式**推导而来。
$$
\dfrac{a^2}{x} + \dfrac{b^2}{y} \geqslant \dfrac{(a + b)^2}{x + y}
$$

### 1. 起始点：柯西不等式 (Cauchy-Schwarz Inequality)
其二元形式为：对于任意实数 $a, b, c, d$，有：
$$
 (a^2 + b^2)(c^2 + d^2) \geqslant (ac + bd)^2  \tag{0}
$$
当且仅当 $ad = bc$ 时，等号成立。

### 2. 关键代换
为了得到权方和不等式的形式，我们引入两组数：$(\dfrac{a}{\sqrt{x}}, \dfrac{b}{\sqrt{y}})$ 和 $(\sqrt{x}, \sqrt{y})$，应用柯西不等式：
$$
\left( \left( \dfrac{a}{\sqrt{x}} \right)^2 + \left( \dfrac{b}{\sqrt{y}} \right)^2 \right) (\sqrt{x}^2 + \sqrt{y}^2) \geqslant \left( \dfrac{a}{\sqrt{x}} \cdot \sqrt{x} + \dfrac{b}{\sqrt{y}} \cdot \sqrt{y} \right)^2 \tag{1}
$$

- 简化右边：$(a + b)^2$
- 简化左边：$\left( \dfrac{a^2}{x} + \dfrac{b^2}{y} \right) (x + y)$

因此，我们得到：
$$
 \left( \dfrac{a^2}{x} + \dfrac{b^2}{y} \right) (x + y) \geqslant(a + b)^2
$$
### 3. 得到权方和不等式
由于 $x > 0$, $y > 0$，所以 $(x + y) > 0$。将上式两边同时除以 $(x + y)$，即得到**权方和不等式**：
$$
\dfrac{a^2}{x} + \dfrac{b^2}{y} \geqslant \dfrac{(a + b)^2}{x + y}\tag{2}
$$

### 等式成立的条件

根据柯西不等式，等号成立的条件是两组数成比例，即：$\dfrac{\dfrac{a}{\sqrt{x}}}{\sqrt{x}} = \dfrac{\dfrac{b}{\sqrt{y}}}{\sqrt{y}}$，简化这个比例关系：$\dfrac{a}{x} = \dfrac{b}{y}$，因此，权方和不等式等号成立的条件是：**当且仅当** $\dfrac{a}{x} = \dfrac{b}{y}$。

### 总结
> 权方和不等式是柯西不等式的一个直接推论和特殊形式，它揭示了**加权平方和**与**和的平方**之间的关系，在求最值等问题中非常有用。
>
> **不等式形式**：对于任意实数 $a, b$ 和正实数 $x, y$，有：
> $$
> \dfrac{a^2}{x} + \dfrac{b^2}{y} \geqslant \dfrac{(a + b)^2}{x + y}\tag{2}
> $$
>
> **等号成立条件**：当且仅当 $\dfrac{a}{x} = \dfrac{b}{y}$

## 三元形式的证明

要证明的核心不等式为：
$$
(a_1^2 + a_2^2 + a_3^2)(b_1^2 + b_2^2 + b_3^2) \geq (a_1b_1 + a_2b_2 + a_3b_3)^2 \tag{00}
$$


### 一、证明过程（作商法）

**证明思路：** 通过将不等式变形，构造出可以使用**均值不等式 (AM-GM)** 的形式。

1.  **第一步：变形**
    将原不等式两边同时除以右边的平方项（假设分母不为零）：
    $$
    \dfrac{(a_1^2+a_2^2+a_3^2)(b_1^2+b_2^2+b_3^2)}{(a_1b_1+a_2b_2+a_3b_3)^2} + 1 \geq 2
    $$
    这个变形是合理的，因为如果原不等式成立，那么左边除以右边再加上 $1$ 必然大于等于 $2$。

2.  **第二步：引入符号简化**
    令 $B = b_1^2 + b_2^2 + b_3^2$， $S = a_1b_1+a_2b_2+a_3b_3$，将分子展开并重新分组，目标转化为证明以下不等式：
    $$
    \dfrac{a_1^2 B}{S^2} + \dfrac{a_2^2 B}{S^2} + \dfrac{a_3^2 B}{S^2} + \dfrac{b_1^2}{B} + \dfrac{b_2^2}{B} + \dfrac{b_3^2}{B} \geq 2
    $$
    
3.  **第三步：应用均值不等式 (AM-GM)**
    证明的关键在于对拆分后的项两两使用均值不等式 $\dfrac{x}{y} + \dfrac{y}{x} \geq 2$：
    
    - $\dfrac{a_1^2 B}{S^2} + \dfrac{b_1^2}{B} \geq \dfrac{2 a_1 b_1}{S}$
    - $\dfrac{a_2^2 B}{S^2} + \dfrac{b_2^2}{B} \geq \dfrac{2 a_2 b_2}{S}$
    - $\dfrac{a_3^2 B}{S^2} + \dfrac{b_3^2}{B} \geq \dfrac{2 a_3 b_3}{S}$
    
4.  **第四步：求和得出结论**
    将上面三个不等式相加：
    $$
    \left( \dfrac{a_1^2 B}{S^2} + \dfrac{a_2^2 B}{S^2} + \dfrac{a_3^2 B}{S^2} + \dfrac{b_1^2}{B} + \dfrac{b_2^2}{B} + \dfrac{b_3^2}{B} \right) \geq 2 \dfrac{(a_1b_1 + a_2b_2 + a_3b_3)}{S} = 2
    $$


### 二、等号成立的条件

**取等号（“=”）** 的充要条件是均值不等式中的每一项都同时取等号。即要求：
$$
\left\{
\begin{aligned}
&\dfrac{a_1^2 B}{S^2} = \dfrac{b_1^2}{B} \rightarrow \dfrac{B}{S} = \dfrac{b_1}{a_1} \\
&\dfrac{a_2^2 B}{S^2} = \dfrac{b_2^2}{B} \rightarrow \dfrac{B}{S} = \dfrac{b_2}{a_2} \\
&\dfrac{a_3^2 B}{S^2} = \dfrac{b_3^2}{B} \rightarrow \dfrac{B}{S} = \dfrac{b_3}{a_3}
\end{aligned}
\right. \Rightarrow
\left\{
\begin{aligned}
&\dfrac{b_1^2 + b_2^2 + b_3^2}{a_1b_1 + a_2b_2 + a_3b_3} = \dfrac{b_1}{a_1} \\
&\dfrac{b_1^2 + b_2^2 + b_3^2}{a_1b_1 + a_2b_2 + a_3b_3} = \dfrac{b_2}{a_2} \\
&\dfrac{b_1^2 + b_2^2 + b_3^2}{a_1b_1 + a_2b_2 + a_3b_3} = \dfrac{b_3}{a_3}
\end{aligned}
\right.
$$

这组方程成立的条件是：
$$
\dfrac{a_1}{b_1} = \dfrac{a_2}{b_2} = \dfrac{a_3}{b_3}
$$

### 三、三元权方和不等式

柯西不等式的一个**极其重要的推论和应用**，通常称为**Titu's Lemma**或**柯西不等式的分式形式**。对于正实数 $a_1, a_2, a_3, b_1, b_2, b_3$，有：

$$
(b_1 + b_2 + b_3)\left( \dfrac{a_1^2}{b_1} + \dfrac{a_2^2}{b_2} + \dfrac{a_3^2}{b_3} \right) \geq (a_1 + a_2 + a_3)^2
$$
或者其等价形式：
$$
\dfrac{a_1^2}{b_1} + \dfrac{a_2^2}{b_2} + \dfrac{a_3^2}{b_3} \geq \dfrac{(a_1 + a_2 + a_3)^2}{b_1 + b_2 + b_3}  \tag{01}
$$

**等号成立条件同样为**： $\dfrac{a_1}{b_1} = \dfrac{a_2}{b_2} = \dfrac{a_3}{b_3}$

## 反向柯西不等式
反向柯西不等式：

$$
(a^{2}-b^{2})(c^{2}-d^{2})\leqslant (ac-bd)^{2}\  (a,b,c,d \in \mathbf{R}) \tag{3}
$$
当且仅当 $\dfrac{a}{b} = \dfrac{c}{d}$ 时等号成立。

**证明**：
$$
\begin{aligned}
&(ac - bd)^2 - (a^2-b^2)(c^2-d^2)\\
&= (a^2c^2-2abcd + b^2d^2) - (a^2c^2-a^2d^2-b^2c^2+b^2d^2) \\
&= a^2d^2+b^2c^2-2abcd\\
&=(ad-bc)^2 \geqslant 0
\end{aligned}
$$
等号在且仅在 $ad-bc=0$，即 $ ad=bc$ 或者 $\dfrac{a}{b} = \dfrac{c}{d}$ 时成立。

---

## 二元应用

|        | $a$                   | $b$                   | $c$        | $d$        | 公式                                                         |
| ------ | --------------------- | --------------------- | ---------- | ---------- | ------------------------------------------------------------ |
| 标准   | $a$                   | $b$                   | $c$        | $d$        | $(ac + bd)^2 \leqslant (a^2 + b^2)(c^2 + d^2)$               |
|        | $a$                   | $b$                   | $\sqrt{x}$ | $\sqrt{y}$ | $\dfrac{(a\sqrt{x} + b\sqrt{y})^2}{x + y} \leqslant a^2 + b^2$ |
|        | $a$                   | $b$                   | 1          | 1          | $(a + b)^2 \leqslant 2(a^2 + b^2)$                           |
| 权方和 | $\dfrac{a}{\sqrt{x}}$ | $\dfrac{b}{\sqrt{y}}$ | $\sqrt{x}$ | $\sqrt{y}$ | $\left( \dfrac{a}{\sqrt{x}} \cdot \sqrt{x} + \dfrac{b}{\sqrt{y}} \cdot \sqrt{y} \right)^2 \leqslant \left( \left( \dfrac{a}{\sqrt{x}} \right)^2 + \left( \dfrac{b}{\sqrt{y}} \right)^2 \right) (\sqrt{x}^2 + \sqrt{y}^2)$<br />$\dfrac{(a + b)^2}{x + y} \leqslant \dfrac{a^2}{x} + \dfrac{b^2}{y}$ |

