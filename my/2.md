我在北京做了20多年，然后其中在三个点做，然后在现在我大概做了快10年，主要是 sophisticated 相关的一些事情。所以要不然你也简单介绍一下。

> 好，我是 2013 年就进入互联网企业做大数据，之前在美资公司做桌面程序，然后 19 年的时候加入到 Kyligence，主要就是做一些性能相关的问题，中间做了很多事情，然后 22年的时候开始做 Gluten，然后就把这个Gluten 从零开始，至少在把它做到生产上了。
>
> Alright. I first got into the internet industry in 2013, working on big data. My previous role was at an American company, doing desktop application development. Then in 2019, I joined  Kyligence,  where I primarily worked on performance related issues. Around 2022, I started the Gluten project,  taking it from scratch and  eventually got it into production.

是这样。对。所以那你你你是 manager 还是 IC 还是

> title 是 Research，然后但实际是带着团队做事情，就是不管人除了绩效考核不做之外，
>
> My title at Kyligence was Researcher, but on Gluten, I was mostly the tech lead, and an IC for the remainder.

ok都要做，但是类似于 technique的角色。对。Ok i see. 所以你你是过去几年一般都是做的是Google相关的是吧，

> 不是是22年开始的，前面一般都是做性能相关的， 

ok 现在也想关了，所以我们今天聊一聊，因为我本身是做对担保相关的东西，那我们做的是主要是 provide一个platform for to run ssoksisisisisisississilsitsisisisisisisisisisilsisisisi，一些就是说够我们或者是说 map就是那些many各种各样的works。Let's talk to this is today最大的空壳了。然后现在而且还是他自己王总产品，所以然后农产品本身在做一些出行安全想歪的事情，做了一段时间了，所以对所以说希望你们有背景的沟通locks，你也做 velox

>  有，我是做 clickhouse 。
>
>  work clickhouse backend.

可以好行行，你跟我上个星期的谁刘能你们是一起

> 对他，他以前是做team里面

也是你们是一起做的是吧？所以现在我们随便聊一聊，就是聊一些技术问题，然后可能是 detail 就是你们做的东西，然后最终后来时间你也可以，你有什么问题你尽管可以，有什么问题你尽管可以问我好吧？那么您能不能讲一讲做的最近的一个框架就是用用户最近一个框架用Gus基于 what did you do exactly? 对你的具体的project是什么，然后你的起的角色，然后具体解决的时候写的角色，然后具体解决一些technical challenges。Ok，然后大概我们okok

> Gluten 是个比较大的项目，我之前做了很多性能优化的事情，然后发现性能都提不上去，后来 22 年的时候，Photon的 paper出来了，其实是告诉我们 JVM 的优化到头了。
>
> Gluten is a pretty big project. I'd been doing a lot of performance tuning work on spark，but we couldn't get any further. **Then the Photon paper was published in 2022,** it shows that there's no room left for JVM optimization.
>
> 有一次开会的时候遇到了intel bin wei，我们就聊到这个事情。Intel 之前做过 Native Enigne 相关的工作，但是性能没啥优势，正好，Velox 那一年也出来的，但不是很成熟，我们比较熟悉 Clickhouse，就这样，我们和 intel 两个团队，一个做 velox，一个做 clickhouse，然后共享 spark 前端。开始尝试做 gluten。
>
> I met Intel's Binwei at a meeting where we discussed this. They had a Native Engine, but it wasn't performing well. Around the same time, velox is also opensourced at 2022, but it was still immature.  Since my team knew ClickHouse well, we decided to build two backends—Velox and ClickHouse—to lower the risk. And both share the same spark front. That was the beginning of Gluten. 
>
> 然后，第一个挑战是能尽快的跑通 TPCH 22，并证明性能是不错。在做之前我其实知道是一些功能限制，但关键是没有 shuffle，所以重点是解决 hash shuffle，大概花了6~8个月时间，22 条跑通20条，性能跑出来比 vanilla spark 快两倍。
>
> The initial goal was to pass TPCH 22 quickly and demonstrate competitive performance. I was aware of some limitations, of clickhouse, and the core issue was the missing shuffle operator. We focused our efforts on building hash shuffle, and within about eight months, we achieved a 2x performance improvement over vanilla Spark, with 20 queries passing.
>
> 然后就继续往下做，就是工程化。这里的挑战是 Clickhouse 本身代码模块化不错，但没有 API，所以这里花了很大的力气做自动 rebase 的脚本，然后，我有部分工作就是解决 rebase Clickhouse mainline 的冲突。这个很重要，一方面我们总是能用到 Clickhouse 最新的代码。另一方面，社区里有既做 Clickhouse，有用 spark 的，这就把他们也吸引过来了，加快了开发进度。然后大家一起，24 年的时候，我们基本上把 tpch 和 tpcds 都 support 了。
>
> So then, we moved on to the engineering phase. ClickHouse had modular code but no APIs, so we built auto-rebase scripts. one of my daily task was resolving merge conflicts to stay current with ClickHouse's mainline. This let us always use the latest code and also attracted contributors from the ClickHouse community, which sped up development. With this teamwork, we supported both TPCH and TPCDS by 2024.
>
> 再接下来的挑战，就是服务于 online service，开发才 8 个月，TPCH 和 TPCDS 都没有支持完 ，老板就有上线的需求，然后没有额外的 QA 给我们，这个时候，我推动团队做了流量重跑的工具，一边跑性能，一边跑功能比对正确性。这里有一个我的亮点，就是在做之前，我就知道 memory leak 的检测很重要，我花了很多时间，找 JNI 内存检测的方案，最后第一次上线的时候确实起了作用。
>
> We were  still working on TPCH and TPCDS. But management needed us to show value ASAP. So the next challenge was getting it ready for online services. We didn't have any extra QA to help, so I pushed the team to build a tool that could replay real traffic. This way, we could test for pefomrance and make sure everything worked right, all at the same time. One thing I really focused on early was checking for memory leaks. I spent a lot of time looking for a way to track JNI memory leak, and that effort really saved us when we did the first launch.
>
> 总结来说，我最大的挑战是在有一个明确目标，即性能提升 2 倍，但不知道怎么实现的情况下，找到一条路证明我们可以达成这个目标。2023 年 9月之后，基本上获得了认可，就可以解决功能和性能问题了。
>
> In summary, the core challenge was the 2x performance goal itself—we had the 'what' but not the 'how'. My key contribution was defining a viable path and proving we could hit that target. After we proved the point around September 2023, we got the green light and could just focus on fixing all the other issues.
>
> 以上是管理上的挑战，研发我做了一些工作。算得上挑战的就是解决 Parquet scan 的性能，目标就是要比 vanilla spark 好，不同的人都参与进来过，一直没有很好的解决。最后是我支持了 Page index，解决了这个性能问题。
>
> On the technical side, a significant challenge was optimizing the Parquet scan to outperform vanilla Spark. Several engineers had tried before, but no one found a good solution. The breakthrough came when I supported Page Index , which finally resolved the performance issue.

> 就是说我们在调研的时候，那个阶段其实最重要是要把一个是它的工程话，就是说一个是它性能行不行
>
> 但在之前在2023年的时候，当时其实因为做了将近快一年了，老板其实有上线的需求，我们其实中间有段时间是解决我们云上服务的一些工作，然后把它给把它给弄上线，然后2224年之后，因为后面所有的都直线了之后，我们把企业级的产品的，也集成到我们的企业级产品里面，然后就有大量的用户的试用这种事情，然后因为我们在25年的时候，5月份的时候，因为公司就可能撑不下去了，最后就收缩收缩我们就出来了，大概是这么一个流程。

> 然后回到你的问题，就技术上的挑战，就是它不同的阶段挑战是不一样的。第一个阶段就是说我们在调研的时候，那个阶段其实最重要是要把一个是它的工程话，就是说一个是它性能行不行，再一个我能不能把它做成工程的东西，因为这里有两个问题，就是可电话是虾粉，他确实是不太好，我们当时和龙哥一起花了很久，然后把这个事情给解决了，当时解决只是解决了希的下放，硕士消费是到了后面才解决的。然后就是哈气的虾粉，然后后面我一下子说了我一下打断了一下子，我们把西的下份解决，然后我们就开始集成到公式，就是解决他的集成的问题，因为他那个代码 Claude的代码，它它的模块化是很好但是它没有一个专门的API说我可以来用你的执行的 engine，然后我们就在这块上面我是花了很多精力，然后后面来做日常维护来做这个事情，后来也是采用这个方案来做的。然后把这个做完之后，然后就开始做那种测试的架构，因为我们全是研发人员，没有测试自动化的测试就是用公司的用公司的，因为我们当时还是有云上服务，我们把公司流量就是做了一个拆分做了一个split，然后每天去跑，每天去跑他流量，当然这里就数据安全很重要，我们去当时去通过CTO去跟用户说，说跟用户做了一个沟通，然后可以把数据流引进来，然后双跑，双跑之后我们把很多，兼容性、的问题、性能问题，副back的问题都逐步解决了，然后我们就上线，然后上线的过程当中第一次上线很就很Qiong，然后有内存泄漏，我们当时在测之前是大在上线之前当时是没发现的，但我们知道有一些我但是我当时是知道有流程系统，只是事前做了很多准备，然后内存泄露发现之后，我们也花了一两天的时间把定位，然后鹿城西路做了，然后上线，然后就离线的上线了，因为然后我们又去在其他客户现场去跑一天，因为我们倒是有一些合作伙伴他们也在用，然后他们也有了也获得了一些经验告诉我们，然后我们去一些用户现场去跟其他的一些产品做PK，然后发现一些问题，然后回来比如说最大的问题，当时发现 sharp如果map就是大了之后我们一定要做short，然后回来又把short做了然后又把又把对吧join发现的一些性能问题，解决了，内存om问题解决后，这个时候就比较完善了，然后等到二四年的时候 tpch和tpcd的都打破的之后，相对比较完善，然后我们就集成到我们公司的整体的产品里面，然后这里就然后做了很多测试，这里主要是测试然后
>
> 我在这个过程当中前面这一段主要是leader的问题和 technical leader主要是去发现问题，然后解决问题，我到底然后要定优先级，哪些问题我要先解决问题我要后解决。好，这个完了之后到后面人因为在走下坡路了，然后做了一些就是比如说pdids，他配的pddddidids是我做的是我在，ch版本上做的然后又做了一些比较highlight的，然后做一些跟德尔塔集成的一些工作。对。这大概是整体的一个问题，然后后面比如说用户上线要去各种现场去要去解决问题，知道听懂了去解决问题这些对。差不多是这样的一个工作。

就是在 data integration之前你给说了一个，你做了一个什么事情没听清楚，

> 德尔塔的德塔之前你说了，你说了个什么事情把这个数据流从卡夫卡到雪城德塔的文件，意见系统反馈的文件排烂，是前面他们做一版做了一版，它是因为在18 3.3的时候，它是需要做它是需要改代码的，然后我后面3.5出来之后，就3.4就可以了，我们没有43.4，就3.5出来之后，我们就把我把这个就集成了这块就可以，不用改spark的源码了，然后我们就可以做了一个重构把这个，代码什么，然后把以前一些没知识的功能，比如说统计信息，比如说比如说统计信息比如说德尔塔的那些立刻的class的调研，然后包括一些aqe就是他在写小文件的时候他要做一些adaptive的执行，然后做了一些这些相关的工作，
>
> 但是没具体的跟他开发了6
>
> 点有关系是吗有第一个最早是因为要上线，因为那什么具体他开发了 ledvc用的是L的他是不支持的然后我在这个基础上我把pdndx给支持了，这是一块工作，然后性能几乎基本上达到基本上不比在应该是说99%的情况下是不比我觉得spark慢了，这是一块，然后后面到真正到用户现场去用的时候，它有一些数据的一些集成工作，就是数据湖的集成工作，比如X book，然后我们要支持S book的图也是，我我做的，然后我们把德尔塔的那个，因为主要是支持他的 delete的文件，这些是我做的，然后就是因为后面人没有了这些研发性的工作都是我在做了，对。

Okay, I see. 所以比如说你在德尔塔集成的时候，底层的这些那你比如说，你在这个德尔塔节省的时候一些detail你需要自己去翻到吗？还是说你比如说就是比如说这个项目，

> 我肯定是他古路村其实当时伟成他你需要写个名字叫古路，他是说是胶水。对，这个到时可以跟伟田做，然后德尔塔所以我们好的地方就是这块协议性的东西我们要了解到，确实是要去了解，但是我们不需要去细节我们就要不要去处理，因为这一块这一块的处理交给德尔塔，我们只需要做什么事情，我们只需要把它事物相关的数据给他准备好，然后我们在数据把在内体里面把准备好，然后传给全回到GM，然后GM然后再调用德尔塔的接口去做 detailed的事情就okay赖正忠就是我们比较这就是这个项目胶水就是补录这些项目，这个项目有优势，的地方就有些我们可以最大化的利用已有的结果。

但是现在话也有你是指什么？你比如说你是spark exclusion engine就是他的一些这东西framework这样的话也有，包括这些combination都是自己可以申报，然后你主要是用这种也framework optimize它的一些房产的休闲包装会，我们就是把它算出来比如说它的规烧它的，一些房产的肯定是要不变，然后框架基本上。 This is 
the shuffle operator. 下坡不累的，然后你把它这个东西是你需要自己就写的时候，你是下坡，然后你把它这个东西是社区没有需要自己就写，需要有那就可以直接用。包括一些那是本地人一般在看他社区有还是没有，然后没有的话，但是你需要还是把你们一般其实你看它设计有还是没有，然后没有的话，但是你需要这也多好这样的下法这当中下法是肯定要自己说的，因为他没有这是必须得自己做的，然后说他是可以完全用的，素材做的比较好，然后 aggregate和joy也是可以用也是用，但是这里就有一些，性能问题或者OA问题需要解决，然后包括join joint是有轭礁一事有那些交易类型，不支持，因为18个里面的交易类型比较，它不仅仅是什么？In a next drawing它还有一些为了性能什么？ Tpch我记得是tph十六有一个is long way long will join，还有 tvcds有 exact exact的join就存在joy是为了解决货的就是这两块当时是把它，它一开始是没支持，后面是想办法把它支持掉了，对，就这种你得自己做。他不支持的，因为然后还有一些就是说性能，比如因为ch它是更加的它是解决它的模式退的问题，它不支持它对法规的它就是用外接的，用艾瑞艾瑞你知道这个性能确实还不太好。所以我们要解决一些，比如pads我们得自己做。对。 

Oki see. 你们大概是很早的这种spark computer这种数据量大概是多大，

> 你们大概是，我们是这样我们分成交互式和这种离线的eto数据量，大概有多大，离线的eto数据量会比较大，他会到tb级别，然后因为我们是做预知，因为knd是做云计算起来的他是会先做预聚合之后，然后再下来的数据就比较小了，所以我们做交互式产品的时候我们的规模是在tvc就是在 100 scale就100规模100G这样的一个，规模做交互式去看它的，性能和做相比，对我们上线上线会跑到etb，对

当前跑一个dvok，那么你那里面用的比如说COSTA这种crowd computer什么是用的是，别的厂公司提供你们用的

> 比如说，美国很多都是aws或者是公司，提供的还是中国都自建，我们都是去他自建的集群上面，然后头疼的问题是它有的很多还是会自己修改。对。对，我们都是去他自己版本上跑，其实特别头疼。比如说我们在二3年的时候去北京一个客户现场，他们自己买了大概 10台机器，然后因为他是做做验证，他做了10台机器，然后叫我们跑。就这样。他临时买了10台机器让我们去做性能测试，我觉得 o

ki see. 所以那么你们跟社区的这种合作是很多吗是吧？还是什么？因为假如说你们这做的东西是公司是属于他的预售的项目，还是指它的本身，就是假如说这个东西去商业化，要它公司是属于它的设计项目，

> 还是它的本身我知道，当然了这个是这样的，其实可能能够商业化里面是几个其他人也可能他们可能负责，其实这个项目没有说一直很安全。这个项目其实我当时是作为研发和CTO，还有包括公司其他麦子之间的一个中转点，其实很多是强力救我的，说你这个不赚钱的你这短时间赚不到钱，你这个怎么办？所以其实是有，当然这个上面有一块 CTO对他的甚至是比较明确知道这个东西一定要有他是帮我压扛了一些压力，但是我另外就是说要赶快，为什么我在做了一年多要赶快我连tpch和tpcdh都没有完全支持的情况下面我要，赶快上我们当时的一个云服务，给大家看的效果。然后为什么在当，而且当时其实我们非常不成熟的时候，我带着团队的人员就是把力量拉出来，带着团队成员去北京跟去做一个PK的项目，当时我们最后技术上是成功了但是因为商业。他给不了很多钱，怎么讲？他比如说举个我怎么来说，就说我这个项目其实我有三四个人对吧？三四，然后我有很多前期教研，我可能人工成本它的成本我可能最近一年可能就要投1,000万，他想可以他居然想四百万人民币，现在我已经400万人民币想包三年，做不了没办法做或者没有去做。因为我们国内在这块特别是大的企业，他们想用，但是他们不想付钱，他们付费的意愿没有这么强。这个项目这也是为什么后面就比较困难，公司就有很不能养活自己后来要裁员的一个原因。
>
> Ok，然后然后就是为了说服就为了说服大家要去做，所以我们赶快上线，让他就要给他看到，比如说两倍成本，比如说让他看到前景说比如说我上线之后，你现在云服务的服务的成本，比如说是这个钱，我现在我现在即使在相同钱下面，我现在会的响应延迟会比它快很多，对吧？快两倍或者三三倍以上，因为小产品有的地方还快很多，然后然后告诉他我将来支持二轮之后，我的成本会降得更多，因为当时非常不成熟，就把研发力量拉去做这些，就必须要得做这些事情。然后24年之后成熟之后，基本上逐渐要想办法要变成底货的一个恩典在做。对

你刚才说提到就是说你做这个东西，然后上线所谓上限是什么？你是给客户提供说你做什么东西一些

> 对，上线是这样，我觉得这里面然后上限所谓上限是你是指给客户提供用户的什么样的服务？就是把spark的那个打开，把雷霆的摁键打开，就是这个oppone打开，这是叫上线。还有一个所谓的上线就是我做的企业级的产品，我要到客户那里线上去做，我已经发布了我已经在我们产品已经发布就是我把我的东西我这个已经allus我这个发布了可以用了，因为我们是做分析产品，它是不需要就是说用户去打开还是不打开，我们确实打开了，打开之后我们就可以到各个用户的现场，直接用他们的真实的 ok路的去验证了。在我研发的角度来看叫上线，当然可能从销售或者从老板的角度来看，他还没有真正的赚到钱。

你那客户用你这东西，因为本身有它的数据是吧？可以用 Sok shoppe来跑去做他的这个David，你那客户要的东西它因为它本身它有前端的客户要用，自己写 spark可以用opsps，是不是？我们的采购它的对像什么初步的是这样，但是前端的客户要用自己写大小或者建拍出来来搞，

> 我们不是这样，我们是提供一个直接一个产品是给出一个circle的用户他是类似于，我们如果你来看的话可以比如说像Sher这样，用户直接写circle去访问的，他不用去写程序什么的。

不是，我的意思从客户来讲，从前端来讲他要写社会语句，你像这种情况他可以写18个水果，对是吧18岁过上面就你的这个平台，你你这个服务把它compared to 我的意思从客户来讲从前端来讲，它变成一个什么logica plan's，Fickel，Facebook plan，最终变成可以写spark S是吧就是这些，刚才我这边你的我的意思就是我的question，就是说你们大概具体在我刚才所说的东西是指哪样？相当于是大概的方案是吧，对最终变成 actually ok就是执行乱这些东西。

> Ahhh，我的意思是我就是说1个全球用户选C C口到1818个他会他的oppemesimess，我们是在分plan的时候就是最后的时候如果是走走原声的它会有一个扣的键的过程叫hosd键扣的键有个扣键的过程，然后我们在我们是在这个把这个过程给骇客了，把它变成转成雷Q的，然后再把这个规划然后再把规划放到后端，然后通过18个机制把它序列化反序列化，然后再到后端再把它变成1个执行计划，再构成1个let5的执行的plan，然后再把然后再来跑。对ok就是完全是。你说。没有，

你像你这种的测试调试的过程当中，假如不是说出了问题，或者是说你这个让这个spark up，结果出来的结果就废掉了还行是X优先的，你们怎么低保没有那你，像你这种在测试调试的过程当中，

> 假如说出了问题或者是说是不是你这个让 spark我不知道出来的，结果交费要了spark本身有很多这种关联性工具，比如OA的，比如日志，对吧？这些问题比如说正确性的问题，其实spark已经帮你解决了，但是这里面本身框架的那种带来的那种正确性问题，我们是假设已经解决了，那只是说我引入的变量是执行算子，引入你的资金算子，

我的一块事情就是当你执行这算子，假如说算子，你怎么知道算子behaves as expected，你包括你刚才其实提到慢慢内科之类的东西，你现在碰到这种情况，第一，我觉得我的意思是说你怎么能拿到这样的分享，

> 你知道错了，这是第一个算，你刚说他来不来？跟我的预期不一样，肯定碰到这种情况是第一，我觉得物理指标你怎么能拿能拿到这样的，

你刚才说的你怎么看出来，从哪个地方看？

> 我们上线之后有系统监控，没带每台机器内存黑的number人，然后黑粉是一根，正常情况就正常情况，它是一根平的线比如说我是64G那我可能是6~48G之后，我可能就就上下 LAN但是我线是一个，从你看到它是这样的，比如说我们看一天比如说它突然就一根缓慢升上的一个斜线，这个时候如果是gom的话如果是那种对有垃圾回收的它是，上去之后啪一一个有一个，马上有一个下坠，对吧可能但是我们因为我们是native的，我们不会有这种情况我们这种震荡应该很小，那我们看上去之后没有下肯定是那种泄露，想都不用想，对吧？这是然后你刚才说的结果正确性这件事情，结果正确性这件事情。不是这个是不能上线去现场解决的，是在线下解决的。就接口正确性，我们上去之后唯一就是说性能问题，比如你性能达不了预期，比如说你某一个C口没有测到你比如说 circle18个围了18个很好，你失败了你就说你因为 om失败了那你这个拿自己拿下来分析，但我们上线前的工作要做的是我上线前的工作我刚才说了上线前的工作是说我要把用户的真实的流量就是云服务比较简单，我把用户真实的流量切过来，切过来之后，我做一个双跑，这边是围了一边是围了18格，一边是 goote，然后两边结果做对比，对吧？结果不对，我就他执行计划是分层的，他分一个算什么，我就一个算子的比哪些算出错，我就看是哪个出错，一个的做比，然后发现问题解决。这样因为在上线前我们一数据错误上线前你肯定得解决，如果解决不了，你没有办法解决不了，你其实上线这种数据错误你其实很难发现。

行，因为我们这几天好忙是因为什么？客户的上面的叫我是这样eigh，那么narr faile那些用户上面了之后就要进入我们的系统，这系统对是其实是各种各样的Micro siss相互之间传来传去的，然后最终传到 caster来去对客户的上面的交往到底是哪个地方要？那么火车票上面我们讲现在这个项目可以其实是各种的各种各样的模式，相互之间传来传去，然后这种猫什么去做，这些东西就先放一下，因为你这到底是哪个方面没有办法直接去期待我们来讲其实是个小的这些到底我们是标准是各种各样的问题，你提的我都开始okay当你还是说你写的大概休息那你因为你的dispute是说我没有办法直接去正常状态结束了你可以比较它的结果比较它的performance这些东西都是对失败的原因是什么？但是你比如说我给大家说说你写的不一定所有的东西都会失败，因为你假如说有几、台机器、的话 ok borse如果是正常状结束了，你可以叫它的，结果比较它的peformance，爱我还是有关系就是你这种情况就是你们怎么做morning day怎么做这个操作设备，假如一个概念，假如说有几、台机器，

> icicsicsichicic，靠自己的sugar。那么有可能失败有可能，施工队Caan得有监控，但确实是的关系就是你像你这种情况 spark你们怎么做monetary怎么做这个是跟国内没关系监控日志，但因为spark有日志，我们本质上其实我们能做的事情就是研发能做的事情，其实因为把用户的日志给下载下来，各种就是eqesqote的日志，然后Java的日志，然后因为它有它这里有，主见有spark组件的，然后有我们自己，肯定就是前端的一些工作日志，把这些拉过来结合着看，结合这个分析，然后到底是哪步错的，到底是机器的问题，比如说我们以前遇到的是比如说在很多个上面，比如说很多公斤经常能遇到的问题，比如说是很多读文件出问题，比如说你经常能看到以前有些问题是只能靠猜的，比如说我去读hdfs，客户不认账，我们说他的hdf是有问题，因为我们看不到客户，对他漏斗的信息看不到对用户对他漏的日志，因为我们只能拿到自己的日志，然后看不到客户对他漏的日志，我们只能通过看这些知识去推断用户的客户的日志有没有问题，因为我们不能拿到所有机器的信息如果能拿到所有机器信息的日志怎么对它漏的，什么 load manager的日志，包括你说什么，这其实是可以做一个完全的分析的，然后基本上通过这样的开始是基本上能找到很多疑点，然后在本地再重新再验证。对。然后当然可观测性就是那种性能的，比如说刚才我说的常规的，比如说各种指标，包括 spark的application的应用层的指标，包括每个机器的那个，CPU的指标，网络的指标，都要有，因为这个是配合我们配合我们来查问题的，包括我们以前在包括我以前在一号店在电商的公司做大数据运维管理的时候，全是各种监控分析，然后找，然后当时特别是那种比如说我记得当时很多谱的那个hdf的节点，还有内存GC的问题，当时能看到明显的能看到几个小时就会有一个，GC的下就是GC的那个，就是内存泄露，它GC的问题很严重的一些GC问题，但是能观察到这些现象，然后要去推对。

假设说你现在你我我们就这个follow你刚才说的ok我现在让这个叫然后其中碰到一个 OPPO来着，用着Google的那个ok来做一个，a joint or whatever. 然后但是你，你最终发现他的，保安们是我sssussin，what we expect我现在乱了我的意思，然后其中跑到一块来做一个 joy or whatever，

> 你意思就是说join的性能不如预期吗？

他的performance是这样我说你你现在你你这个教案假如说你是自己写一个operater, whatever form，因为就像你说的也是各种各样的情况，你现在你写一个ok的 Wright operater我想这并不是简单的就是online Rai，他基本上是formic set up operations in order to take into做就完成你这个教案，现在你觉得他这个方案不如你想象的就像你说的那你你怎么去identify我想 Wright基本上是formic settler population giu

> 我就拿我们生产遇到的问题来来讲做这个就完了。我们现在现在在对不是的就是客户现场，去做P pf的时候和QC的时候遇到的问题我来讲就是我们去客户现场，有一个join始终跑不出来，始终跑不出来，老是om，然后客户数据又拿不到，不准我们用客户的数据就我们不能把客户需求拿下来，因为这里有一点，其实我的经验来讲，只要有客户的，只要有数据，只要有客户数据的分布，有数据的一些东西。这个问题很容易重现，是很容易重现很容易解决，就是像我拿到钱之后，我就只要去看代码，然后根据它的分布一看就能知道，所以这个很容易，但是痛点你在客户现场拿不到数据，这个时候怎么办？通常的通常的做法就是去了解它的数据类型到底是什么类型？是史俊还是 guid还是什么whatever，反正就是各种类型。但是然后了解它的数据分布，了解它的数据分布，了解它的，数据分布就这个数据到底它这个数据是里面比如说它 join到底是有没有膨胀？到底是enjoy还是 lphord还是corsgoringingsinssinsssss，然后有了这些信息之后，我们回过头来在本地的环境去随机生成数据来做，从来来做来做重新来做，来重现，来重现这样的问题。然后重现完了之后，然后来到时候再来找。对。你说。找这个问题的过程确实很头疼，看代码，看日志，分析客户现场的状态，啪啪啪的就拿过来，然后然后你来模拟模拟说在你**绞尽脑汁**想你它到底是什么原因，根据代码你来想到底是什么原因来串前后的因果关系，是因为这个原因导致这个结果，然后我现在有这个现象，他是不是这个原因，然后这么来串，圈完之后，重现之后发现是这个问题，然后再去问用户你是不是这里有一个问题，他说是这样，然后我们比如说有些情况下，比如说换一个参数就可以解决，有些情况下是不行。比如说比如说我们在客户现场，比如有个车库跑出来，有时候跑不出来我们就拿在circle我们是知道的，我们拿这个circle我们就在本地不停的模拟，各种环境不停的模拟，然后看代码，看完代码说有一个option是不是你不对，让他去验证，果然一验证对就是各种的这样的差错，对。

所以实际的这种全部修整还是比较没那么怎么样比较繁琐，没那么简单了是吧？

> 对各种各样的人对他需要需要对环境，它主要是因为它是各种环境引起的，你要对像实际的你要去猜，你通过线下去猜这个环境到底里面有什么因素因子导致的，

怎么讲比较那你这个东西就是相当于你很多时候你什么你是你要自己写 test，稍微写unit test，integration test还是的，就得上线之后发现问题以后， 

> ohh cai investigation，uhhh，Yuli开始，肯定是要写集成集成测试肯定这个东西，就是相当于你很多时候你什么你是你要自己写，现在的要求因为我自己一边一方面是比较这方面也是上线之后发现问题以后，一个是我自己代码是要要有ut的就是到保证能代码都能跑到，各种情况基本能做到，能自己想到的都不要遗漏。然后集成测试集成测试就是两块，首先是一块自己比如公司内部他们有一个自动化的是要跑的，这个是要去过的，是研发要自己去跑的，这是一块。还有一块就是说我们有那种性能测试，就是那种tpchtpcds的我们会周期，每我们会店里的跑其实我们是代理的跑那些跑这个东西，然后看那个结果有没有对就是tpc和tpcds的，对。这是一一侧，然后刚才我说的上线的在线服务的双方用流量劫持转来跑来对比的，这种对比结果的，对都是都各种就是这种保障都要做的。我们现在我们不做的是什么？我们不做的是那种手工测试，手工测试我们不做，手工测试是有专门的测试人员，有 qa去做但我们全是自动化的，就全部是比如说，因为我是C口的，其实能做自动化，基本都能做到自动化。对

ok那你，刚才你说 unit test coverage一般能达到多少

> 都明白，自己写code的吗，我没有数据支撑，这个没有数据支撑，我自己基本上能做到 90%或者99%，但这个没有数据支撑，都是靠我自己估计。 C加加做到C加加我找不到什么加法？就是gmsgan能做到多少加？就是gmsgan能做到。能发散的基本能看到它有一些比如说你新加的代码，因为有有索拉有这种各种来做，但是 C加我没有找到相关的这种东西，

但是对那么你你这个常用的语言，你C加加是应该是你是不是，你比较擅长

> 对。其实ca加是是我工作之后是1998年，到12年之前是搞用C加加的ok，然后后面就是用吃嘎用夹子夹了就擦了。然后你做22年做这个项目的时候为什么我，敢做这个项目应该是C加的，因为当时我们公司没有人懂擅长，对其实不是Java base，但是为什么我感觉是因为我知道C加加我熟悉，我差不多shooting是可以的就是我，可能这个语言自己从零开始写有的地方宽 structure， capture可能不是那么的Xun但是我能我能看得懂我知道，他这个原因是什么他 fix bug这里面，这个是我是有有信心的，然后ok，然后现阶段回过头来搞了两三，年之后基本上怎么说呢他C加加20的一些规范我可能是不知道，但是像sto像这些基本的我还是了解的能用能写。对。

Oki see，但是你们比如说你们公司ship的东西，你当然你是说起一个在的作用，然后有一个厅来跟你一起来，或者但是你们这种是什么是你比如说你是需要这些feature，是你们自己决定的还是由叫什么叫product manager之类的，但是你们比如说你们公司ship的东西，你当然你是说起一个团队的项目，现在你你说你这个有各种各样的教育场景还是不一样的我们需要增加一些offer，这种是什么是你比如说你是需要这些feature，是你们自己决定的还是本来应该是？

> 对应该是叫什么叫product manager，对无非就是下面规是抓到的东西，然后或者他哪个架构要哪个架构，比如说我要什么样的部署，要很多的部署，各种各样的这个叫场景一样，需要他来做的opera operator来讲这种东西你就，后面不是在走下坡路，其他产品就是在变就已经在变少了，所以就相对来说比较单纯。其实因为我们这个是古楼镇是对18阿哥，我们是跟18个，所以我们是简单说我们的future的话无非就是要替代spark，那就是要做无缝的替代，做无缝替代这件事情。那我这里有个取巧，就是我只要性能不回退，或者就是说我性能一定要比它好，但是性能不回退，然后要有正确性，在这个基础上你就可以来选择，哪些支持哪些不支持，但有些外部条件确实是比如说我要，我主要是基于什么部署，我主要我是先走还是先走的霍克，这个事我决定不了的，这个是老板决定的，然后老板来告诉我之后，我们再来来投入力量哪块，但是具体到哪个function，其实是有标准答案的，因为更难就是我现在，因为我们不是我们是一个产品我们是一个对外产品用户是直接用circle的，其实我们也不像微软或者是aws这样它是提供一个spark它可能有自己去写udf，我们不需要我们不会，我们都是我们只是即使是自己写udf或者是自己要用功能我们都知道的，就有什么扩展我们都知道的，然后哪些是优先级高的，哪些是优先级低的，我去跟另外产品就是我要集成我这个产品的，就是我的使用者或者叫我的用户，不叫客户就这个看你们说一个叫最终用户一个叫做我的客户我的，用户就是用blue的用户我去跟他谈，因为他是有一个明确需求列表的，哪些叫支持，对吧？这个是知道的，然后我就可以去做了，然后然后在测试的时候，因为我不是说我们有一个自动化测试框架，我们基本跑完自动化测试框架，跑完之后基本上因为它，因为group有一个什么不支持算值列表，然后有些性能列表制作之后，我们马上就能知道，马上就能知道哪些东西不支持，然后把这个不东西支持的东西拿去问，说你哪些要我先支持的，他马上就会给一个列表，但是但是因为我是从做以前企业级产品出来的，我其实知道它里面有哪些功能是比较重要的，我不知道的是哪个表达式，它需要支持它的优先级怎么样我不知道，但是重要的一些性能算子，比如说反馈的sky比如说一 S三的集成。比如说它的一些比如说它有做一个罗恩比特卖普做 count distinct的一些做的一些聚合算子这些算子很重要我知道的我就在之前我就让人先我就让天门办先去做了对。

所以我们我们时间差不多，那你比如像你平时一一般花多少时间，自己去写code？

> 后面多了，我现在又花了好多时间去做那个例子的角色，但是我觉得后面多了二四年多了，二四年之后，协调少了之后，基本上我要写代码。我是 okay所以我们，我们时间差不多那你你觉得很简单一点，你平时一般花多少时间去自己去写cos也是？所以在24年之前，你是一直做 manager的角色，还是20年之前，在19年到22年这段时间我是独立IC就解决性能问题，这是独立IC22年到24年这段时间其实是做D的是带leader的角色，然后这中间我做的最最重要的一个工作，就是三三件事情一件事情是我为了保证上线我要去，那在奥斯里之前你是一直做，然后 manager比如说那种比如说，我你知道Java是可以出错的时候会把异常给打出来，但是C加加你自己不做你不做这个是没有的我把这块我去接信号把它做出来基于cloloss的那些功能，然后结合起来做了一块这是两块，为了保证上线要做的工作就是在20年之前，然后还有一块性能就是 pptindsidx，支持配电堆是这块是他会实干这块，因为这块你如果不做你根本上不了线，因为你解决解决不了因为我们到时候，我们去和spark去做5年的时候做比比拼的时候这块差距非常大。

你刚才在说我就配这个什么？Page index. 好可以的，配进去是做过滤。因为我们时间也差不多了，你能不能稍微的也展开一下所谓配置应该是这个东西你刚才先说完了，

> 我那边的叫偏了，它是按月它是按列做影像的，对案例做预科的，然后每个column它有配置，然后按配置来做压缩的，对吧？每个配置压缩，然后再压在，然后在配置里面做隐扣的时候压缩。然后他的问题点是说实在查不到你那边跟房主对齐，比如说我这个文件有100个行数，有需要稍微配置index，然后每个行组里面比如说1万行都是1万行，但是这1万行有不同的列可能是这个是，这里是100页，这里是10页，那里是20页对吧？就是我可能要，然后这个时候我有一个filter我这个filter下来之后。它是各种之后 conduct之后它不同的列可能有不同的需要选择不同的，页码，对吧？它不是那种对齐的，你就要把你就要通过行号通过一个算出一个如果乱记你算出这个range之后，你得到了得到一个说我，每个列都行组每个行组都有一个，但是通过 Runge你到对应到每个列你知道他有他有哪个页，比如说列是1页3页4页，比如说这样，然后页是5页五六页7页，然后把这个之后，然后你就在把这个信息取掉之后，在读每列的时候，我就把这些页都给他都不去读都不去下载，因为它是串行，它是顺序的，我就不去下载，我就跳过这些不要的页。然后我传给抵扣的的时候，他看到的一个完整的反馈文件或者是反馈的流，他并不知道说我已经把不要的数据做过滤了，这块是对在云上面对延迟是有非常大的作用的，因为你读文件确实是读文件就是这个，跳跳度非常重要就是Skype io，效果是非常好的。然后把这个月跳了，跳了之后到后面再去做抵扣的，对。

比如像现在spark本身它应该有这个地方的这种率的吧是吧你觉得，它看到是它是结合

> 它是，Java的它是，9月份它不是C加加的，它不是aptil的。

 I see the default. 娜娜C加都得自己重写写，

> 你假如说要要第二位发给 differ的这种arab。你觉得他是看到鄂上次 Xu H Clouse，然后你知道就是把这个，他没做的工作就把Clouse，没做的工作，进行deborde culehohersssss。那行这报就是找到这个框架找到盖普找到盖普把这个，盖普给他做掉，然后调用就行了，那C加加得都得自己重写写，你假如说是要你要dowss，

那样我们放过来已经6点多了，ok现在你这样你也有那么关心我吗？因为我本身其实对这个intern这东西就是觉得你们做的并不是很清楚因为我这样我跟你说了，我们做的是一个平台平台给你提供这基本上是，一个hous点的一个东西，你比如说我刚才问你就是说包括你们要要 former computer就是lost这些 past现在你也像在微软那边我觉得有一个就像这个事件本身其实对这个 caster就看中你的消费保障有一个大的。我这样我跟你说我们做的是100台机器平台跟你们提供那有的小的叫几台机器， host的一个东西，你比如说我刚才问你就说你们要但是对上面的一些具体的、房产东西其实怎么我知道一些因为我跟他们那边也接下了，这个上面是不是不是那个Custer point，ok anyway我想你有什么培训可能会需要几百台机器，都要负责现在，

> 但有的小的叫他要招就可以了，招过去之后大致对这个团队，但是对于上面的一些具体的long time要求是希望做到什么东西怎么着我知道一些因为我跟他们也我靠这个东西了解吗？

对这个我大概我去我只能告诉你我知道的情况 fabric是相当于现在微软一个很很重要的一个产品线了啊，原来 a就对的，我们就是大数据，我们叫her data。整个大的一个department下面现在处在一个最大的，产品就是叫做fabric这个东西。 Facebook的它本身是包括有几个，产品我大概一个是，我们叫抛跌我知道的情况，因为fabric是相当于现在我有一个很很重要的第三个就是画这三个里面的18，个是原来就是应该是最重要的就是因为或者是说发展最快的因为这个data warehouse已经相当于是做了一个最大的微软已经有了有一段时间了，以前不叫 fabric的，它本身是包括抛边应该是它的规模比较小一点PPI，因为它是moreover llah客户去zai那些报表之类的，这三个里面应该在发布里面应该是增长最快，因为 data warehouse相当于是我们电影现在主要是负责 sparse这一块儿而且这种老板就T恤也是我的老板比较小一点，就他因为他是猫。拉客户去针对 spark，narr sparse试试，然后像我们应该是在，然后我们看到一个叫clos，你可能以后会知道 cospsossssssssssssssissisisisisilsisisisilsilsilsilsisi而且老板就偏小说，然后当然有他自己的语言自己的 class这是什么方法在整个 us park's在这里面说的，像我们有很多的电影，而且我们刚好有个叫COSMO S，我刚才可能跟你说他是就以后会知道，但是因为就好像要做在外面你为了自己做一个cosmos他会孙彦芳就让，然后当然他做自己的data analysis来看这种了之后都会到 klaas情况。No，that's okay，都是有好多的来。Teem就要 spa。出来的。就是说你包括它的spark except用户他会都是多少office，但是已经相当于微软从 CS他拿过来时候，已经好多年了基础之上了以后给我的他乱的时候他又不能装太多，谁知好谢谢。接下来你跟郭文成文硕是那个一样的，你也从那边拿过来，你也是从我们硕士来的，就是说包括他的sparsilsilsilsil调到这里来，不是我们都是open source拿过来之后拿过来，好多年了在这基础之上有分别作为，然后他学习一下，feu，chernow也Kao，这个SPARC对农产品这一块是没得一样的，现在有多少人你也从这边拿过来，然后很重要就是说他不方便说现在就是说包括spark young因为我们compared，就是我们竞争的对象主要是Debbi，相貌之类的在上面，然后 emermer之类的这上面，然后他们都提供同样的放，然后做每个厂家有不同的优点是哪个，我们poy的 spark的最大的优点就是现在12块，所以靠这边是这个吧，他们一个同样的叫做同样的事情，微软的你算下来之后，会发现compan就是竞争对象主要是deady，向M种怎么说就是more cost effective，然后他们提供从另外角度来讲它对有些每个厂家有不同的优点了，为了你比如像我们假如跟lx的最大，优点就是cossey，一些消费peformance就是depends on verry的特性，叫比如说，一些koh快，为了这个算下来有些特殊的东西，其实它的性能不如 SB，当然有好多种原因，因为猫你可能知道从另外角度来讲它对有现在是是开源还是其实基本上是对break，你比如说像我们假如说有些东西好多东西都是他一些spark，知道他们做了一个产业化，他如果不，我们邵总你也不知道，所以我有一些口 call quarry，然后有些特殊的东西就是他就一个是看差不多的，当然有好多种原因这是一个另外一个就是看你可能知道 Bugge包括材料的，bucks对现在是开源，可是其中的 regent valve包括一些东西探索什么各种各样的，不知道他们做了一些什么优化，他如果不会造成我们也不知道，所以微软做了好多事情 anything having problems都会try to guess现在因为这个平台基本上是比较成熟了，包括我们后来另外一个菜，我们加一些，然后包括超级奥特曼整体的框架，但是它的其中的你看一个主要的focus，刚才给我们自己做各种各样的都是已经做了一段时间，在两年了，现在看起来效果还不错现在因为这个平台基本上现在好多还是需要，别的去这个平台然后去改进，包括 spark这个框架，但是它的performance，所以就是你你我们希望到找一些这方面的一些 promised你们 native exsolution已经做了都成了Alex或者是开发类似的这种，对对于，然后但是其实好多还是需要休闲这类东西比较熟悉，然后这个hope就是可以hope with。

所以你这个我们希望找找一些这方面的一些 expert，所以 back to stss比如说这一部分在做了格鲁加纳瓦克斯，就是或者是开考的类似的这种，结成了Anh，然后对于拿到的做系统ir xman，然后就是说

> 能够加入团队目的就是首先要解决的比如说，

hopefully就是可以how with投放但是你，你提高性能，现在好像也没有什么其他的不好意思也就是native social在然后上层大家都都是用sap来 optimize这类的它的框架做，那只有就是在，execution方面多动脑筋，然后也会做一些开心之类的联盟下否在各种一些，因为这类东西就是whatever can还对主要是这些但是你，你提高性能现在好像也没有什么其他的好的刚好的翘一次也就是 QQ群而已做，然后上层大家都都是用spark来 up就卖之类的它的框架做，我们只有继续加一些设计。是 ok。然后也也会我们我也向原告的为什么现实都研究这个东西 Angela，这类东西就是whatever can help which machine it's kind of technology. 

我们叫aks，然后也有一个讲Asia contain sense就是不是让在eckes，我们这这些东西都是肯定的basis to technology这对我们来讲我们的微软的现在线下全落在怎么讲因为没有，但是Aisha都给我们，这个品牌就是eigh，我们当然也有eph的用的bass parcel那里看我们都是通过 STK conce的去prevent SDS。对就是把它叫succeed on the stage to把把它先连起来，组成一个cuss，通过一些对比一下系列写麻烦到您。但对我们来讲不是怎么讲umer BMI contain a这就是个computerite right，我在这里，所以但是azure都给我们，这个平台就是需要一个 classy那里收入都是通过 STK想问一下考研，可以改变我们自己把它说我们这次我们的stage就把它串联起来组成一个市场占有率，用户通过一些scratch的一些。

> 没有它前景应该跟其它的，我看看我感觉应该是还很不错的，

对。我本来想问一下他应该在微软内部这些产品应该增长率应该是最高之一了。Okay, year over year targets有去年到今年55%增长率。

> 现在AI带来的影响有多大，就是说然后也带来的影响，

我不知道你看上次的细胞微软的细胞没有，上次微软上次的细胞是挺不错的，比前一次要好，前因为再前一次这不是未来应该是很多，在AI上应该是那个时候还没有看出多少在被它的财报有多大的帮助刚过去，财报有去年到今年不错，就是你能看出来AI对这个，微软财报的一些一些帮助。我们现在aiesilesilsilesilsisisisisisitsi上次的情报回来的情报没有上次回来上次的情报现在我们其实是比前一次要好一些，因为在前一次这边在广部这边，未来一般e生活在AI上你除了是特殊的需需要的，像你们有这种技术是应该说是比较需要的特殊需要去跟过去财报，现在不早了，不错的很还是不错的很难看出来，我们可以用AI去做，这好多一些帮助普通的技特别是junior的那我们比方说，他说的是现在AI都可以做，而且回来，你本来也是知道的，所以不管是怎么样，微软是提供的服务招人了，就说是你特别在微软我们这边的或者我们自己做事情，你除了是特殊的，我们学校的像你并没有问你有这种技术，应该说怎么样但是我们，我们我们自己用的AI硬件软件微软不造成一个很大的复学是很你好多普通的从他做的是现在宣传，或者银行对员工的一些要求，对ailsis不管是怎么样，就是微软是提供的服务。或者是我们自己做事情AI是everywhere，当然我们今天我们只是跟你那边我并没有问你，你只是要爱你的但是我们，我们我们自己用的ais，那行微软是这边压迫。也感兴趣，谢谢您，不管是从他的产品，不管它的宣传嗯。